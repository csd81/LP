## üç∑ Motivational Example: Fr√∂ccs

A continuous decision problem for motivation, and to discuss basic concepts and principles.

---

### Prerequisites

√Ånyos Jedlik was a famous Hungarian engineer and priest, primarily known for inventing the dynamo and a machine to efficiently produce carbonated water. According to some legends, he was the first to conceive the idea of mixing this water with white wine to create a refreshing drink. The resulting beverage is called **Fr√∂ccs** (or Spritzer in some German-speaking countries).

---

### Disclaimer

Writing "carbonated water" repeatedly below would be tedious, so I will simply use the term **soda** instead. I am fully aware that in some countries this can mean coke or other fizzy drinks, so please be advised and **do not** start mixing coke with white wine. (If you must, mix it with red wine to get a **Vad√°sz**.)

---

### Problem Description

Imagine that we are the managers of a pub that sells only the following varieties of fr√∂ccs at the listed prices:

| Name | Translation | Wine (dl) | Soda (dl) | Price (HUF) |
| :--- | :--- | :--- | :--- | :--- |
| Kisfr√∂ccs | Small fr√∂ccs | 1 | 1 | 110 |
| Nagyfr√∂ccs | Large fr√∂ccs | 2 | 1 | 200 |
| Hossz√∫l√©p√©s | Long step | 1 | 2 | 120 |
| H√°zmester | Housekeeper | 3 | 2 | 260 |
| Viceh√°zmester | Vice-Housekeeper | 2 | 3 | 200 |
| Kr√∫dy fr√∂ccs | Kr√∫dy fr√∂ccs | 9 | 1 | 800 |
| S√≥herfr√∂ccs | Stingy fr√∂ccs | 1 | 9 | 200 |
| Pusk√°s fr√∂ccs | Pusk√°s fr√∂ccs | 6 | 3 | 550 |

You may be unfamiliar with the measurement unit of a **deciliter (dl)**, which equals one-tenth of a liter. However, if you visit Hungary, portions for wine, soda, or other drinks are usually measured in deciliters (except for strong alcoholic drinks, which use centiliters (cl)).

As you can see, some of these names have cultural references; the Pusk√°s fr√∂ccs pays respect to a famous football match that Hungary won against England in 1953. If you ever try fr√∂ccs in Hungary, please keep in mind that the prices vary significantly from place to place. These are just estimated prices for a small village pub in 2018. Also, there are many other variants, but we will stick to only these eight for now.

After this cultural detour, let's get back on track and define our **optimization problem**: we have a fixed stock of **100 liters of wine** and **150 liters of soda** for a day, and we want to achieve **maximal profit**. We can assume a few things:

* The guests will ask us what to drink.
* Our guests will always remain thirsty.
* The guests will even accept "partial" servings, e.g., we can sell them a half Kr√∫dy fr√∂ccs for 400 HUF.

I am well aware that this is a very idealized and unrealistic example, but it will serve us well for now. Furthermore, the profit value we determine this way will be a strict upper bound on the actual profit we could achieve in a real-world scenario where these assumptions are not met.

---

### Trial and Error Approach

Similar to the festivals example, try to find a good solution by hand first. Do it either on paper, Excel, or use this simple tool below.

| Variety | Servings |
| :--- | :--- |
| Kisfr√∂ccs | 0 |
| Nagyfr√∂ccs | 0 |
| Hossz√∫l√©p√©s | 0 |
| H√°zmester | 0 |
| Viceh√°zmester | 0 |
| Kr√∫dy fr√∂ccs | 0 |
| S√≥herfr√∂ccs | 0 |
| Pusk√°s fr√∂ccs | 0 |
| Wine Used | 0 l |
| Soda Used | 0 l |
| Current Profit | 0 HUF |
| Max Profit | 0 HUF |

---

### Applying the Ideas from the Festivals Example

If you don't remember them, follow the link above, and after re-reading it, try to determine which ideas can be used for this example and which cannot.

---

### Brute Force Approach

Our third assumption above was to allow "proportional servings" of these beverages. It is easy to see that this results in an **infinitely large solution set**. If only rational numbers are allowed, then the set is "just" countably infinite. Otherwise, if irrational proportions are also allowed, the cardinality of the set of solutions is the same as that of the real numbers. Either way, no brute force algorithm can cover all of them.

---

### Greedy Approach

A greedy approach can probably be constructed for any problem, and this one is no exception. Several variations could be designed; here are just a few examples:

* The Kr√∫dy fr√∂ccs is the most expensive one; sell as much as possible of that.
* Based on the wine-to-price ratio, the S√≥herfr√∂ccs is the most profitable; sell as much as possible of that one.
* Since we have 1.5 times more soda than wine, wine is $3/2$ times more "valuable resource" than soda. Based on this, we could calculate a price-to-ingredient-value ratio for all of them and produce the most of the one at the top of that list.

Generally, a greedy algorithm would continue with something like "and then select the second most valuable item, sell as much as possible of that, and continue this until we can still sell something." Since here we only have two ingredients, and both are required by all of the fr√∂ccs types, there could be no such iteration. This type of iterative approach would be meaningful for more ingredients and products where the products do not always require all of the ingredients in some proportion.

Similar to the festivals problem, the greedy approach will not necessarily provide an optimal solution here either.

---

### Simplify the Problem by Pre-solve

Some types above are simply not worth selling. Try to figure out which ones yourself and why, then click on the button to check if you have discovered them all.

The simplest to observe is probably the **Pusk√°s fr√∂ccs**, as it is equivalent to selling three **Nagyfr√∂ccs**. The latter would make 600 HUF profit, while the former costs only 550 HUF.

**H√°zmester** is slightly more difficult to see. It is equivalent to selling a **Kisfr√∂ccs** and a **Nagyfr√∂ccs**. While the combination of those two would bring us 310 HUF, H√°zmester only brings 260 HUF. In a similar fashion, instead of selling **Viceh√°zmester**, it is better to sell a **Kisfr√∂ccs** and a **Hossz√∫l√©p√©s**, as it would bring 230 HUF instead of 200 HUF.

The only types that remain are the following:

| Name | Wine (dl) | Soda (dl) | Price (HUF) |
| :--- | :--- | :--- | :--- |
| Kisfr√∂ccs | 1 | 1 | 110 |
| Nagyfr√∂ccs | 2 | 1 | 200 |
| Hossz√∫l√©p√©s | 1 | 2 | 120 |
| Kr√∫dy fr√∂ccs | 9 | 1 | 800 |
| S√≥herfr√∂ccs | 1 | 9 | 200 |

Another easy thing to observe is that if we sell a single **Nagyfr√∂ccs** and a **Hossz√∫l√©p√©s**, that would require $3 \text{ dl}$ of both wine and soda and produce 320 HUF income. That is less than selling three portions of **Kisfr√∂ccs** for 330 HUF, which would take the same amount of ingredients. This means that **Nagyfr√∂ccs** and **Hossz√∫l√©p√©s** will definitely not be sold together in an optimal solution. Similarly, 10 **Kisfr√∂ccs** is better than a **Kr√∫dy fr√∂ccs** and a **S√≥herfr√∂ccs** combined.

As a result, we know that in the optimal solution, at most three different types of fr√∂ccs will be sold, but we cannot eliminate any more rows from the table yet.

What we did when we eliminated some fr√∂ccs types was to "cook up" a recipe for how it can be made from other types in a more profitable way. If we order the types based on the wine-to-soda ratio, we get the following table:

| Name | Wine/Soda Ratio | Wine (dl) | Soda (dl) | Price (HUF) |
| :--- | :--- | :--- | :--- | :--- |
| Kr√∫dy fr√∂ccs | 9 | 9 | 1 | 800 |
| Nagyfr√∂ccs | 2 | 2 | 1 | 200 |
| Kisfr√∂ccs | 1 | 1 | 1 | 110 |
| Hossz√∫l√©p√©s | 0.5 | 1 | 2 | 120 |
| S√≥herfr√∂ccs | $0.\overline{1}$ | 1 | 9 | 200 |

It is simple to see that any fr√∂ccs type can be "cooked up" from a stronger and a weaker beverage. If there are three types in decreasing wine/soda ratio: A, B, C, then there are non-negative real numbers $\lambda_A, \lambda_C$ such that $\lambda_A \cdot A + \lambda_C \cdot C = B$.

But what exactly do A, B, and C mean in this equation? What we want to express is the amount of ingredients they require. So they are basically ingredient vectors. Let's look at an example with Kr√∫dy fr√∂ccs (A), Nagyfr√∂ccs (B), and Kisfr√∂ccs (C):
$$(9, 1) \cdot \lambda_A + (1, 1) \cdot \lambda_C = (2, 1)$$
This basically results in the following system of equations:
$$\begin{align*} 9 \cdot \lambda_A + 1 \cdot \lambda_C &= 2 \\ 1 \cdot \lambda_A + 1 \cdot \lambda_C &= 1 \end{align*}$$
The solution to this system is $\lambda_A = 1/8$ and $\lambda_C = 7/8$. This means that a Nagyfr√∂ccs can be made up of $1/8$ Kr√∫dy fr√∂ccs and $7/8$ Kisfr√∂ccs. The profit from that would be $1/8 \cdot 800 + 7/8 \cdot 110 = 196.25 \text{ HUF}$. This is less than the price of a Nagyfr√∂ccs (200 HUF), which means that selling Kr√∫dy fr√∂ccs and Kisfr√∂ccs together is not a good deal.

Without realizing it, this is basically how we proved that Kr√∫dy and S√≥her fr√∂ccs are not good together, nor are Nagyfr√∂ccs and Hossz√∫l√©p√©s. The other outcome of solving such an equation system could have been that the middle one (B) is less profitable, which would mean it can be eliminated.

Try to eliminate some other fr√∂ccs types with this approach.

This type of elimination is a glimpse into the logic of the **Simplex method**, which will be discussed later. If the stronger and weaker beverages are in the "basis," the difference between the price of the middle one and that of the mixture will later be called the **"shadow price."**

---

### Investigate Only Feasible Solutions

As previously discussed in the case of the brute force approach, there are infinitely many solutions. This is also true for the feasible ones, so this would not really help us. The search space could be significantly reduced if we only examine solutions that use up **at least one ingredient completely**, which means they cannot be improved by selling a bit more of something on top of that solution. This way, a lot of sub-optimal solutions can be disregarded.

However, even if we only consider **Kisfr√∂ccs** and **Nagyfr√∂ccs**, it is still easy to see that there are infinitely many solutions that use up all of our wine storage. Try to find such solutions yourself, and prove that there are infinitely many others.

---

### Final Notes

This problem is seemingly more difficult than the festivals example because having proportional servings made the number of solutions infinitely large. At this point, we would assume that restricting the problem to whole servings would render it simpler, because the number of solutions would become finite, and thus enumerable in a finite amount of time. Contrary to our expectations, it is the other way around, as we will see in the following lectures.