
## Advanced GMPL Models for Motivational Examples

-----

### Prerequisites

Advanced GMPL techniques: **data/logic decoupling**

We have already created the advanced model for the **Festivals** example. In this practice session, try to do the same for the **Fröccs** (Wine Spritzer) example.

-----

### Advanced GMPL Model for the Fröccs Example

First, try to create a more **general model** where the Fröccs types are provided as **data**. The initial step is to identify the necessary set and parameter definitions.

#### Sets and Parameters

| Mathematical Notation | GMPL Code |
| :--- | :--- |
| $F$ | `set FroccsTypes;` |
| $p_f \text{ for } f \in F$ | `param price{FroccsTypes};` |
| $s_s$ | `param soda_stock;` |
| $s_w$ | `param wine_stock;` |
| $c_{s,f} \text{ for } f \in F$ | `param soda_content{FroccsTypes};` |
| $c_{w,f} \text{ for } f \in F$ | `param wine_content{FroccsTypes};` |

The second step is to create the variables, constraints, and objective function of the generic model.

#### Variables, Constraints, and Objective Function

| Mathematical Notation | GMPL Code |
| :--- | :--- |
| **Variables** | |
| $q_f \text{ for } f \in F$ | `var quantity{FroccsTypes}>=0;` |
| **Constraints** | |
| $\sum_{f \in F} q_f \cdot c_{s,f} \leq s_s$ | `s.t. SodaUsage: sum{f in FroccsTypes} quantity[f] * soda_content[f] <= soda_stock;` |
| $\sum_{f \in F} q_f \cdot c_{w,f} \leq s_w$ | `s.t. WineUsage: sum{f in FroccsTypes} quantity[f] * wine_content[f] <= wine_stock;` |
| **Objective Function** | |
| $\sum_{f \in F} q_f \cdot p_f \rightarrow max$ | `maximize Income: sum{f in FroccsTypes} price[f] * quantity[f];` |

Finally, provide data for the model in a data file:

```glp
set FroccsTypes :=
  kisfroccs
  nagyfroccs
  hosszulepes
  hazmester
  vicehazmester
  krudyfroccs
  soherfroccs
  puskasfroccs
  ;

param price :=
  kisfroccs     110
  nagyfroccs    200
  hosszulepes   120
  hazmester     260
  vicehazmester 200
  krudyfroccs   800
  soherfroccs   200
  puskasfroccs  550
  ;
  
param soda_stock := 1500;
param wine_stock := 1000;

param soda_content :=
  kisfroccs     1
  nagyfroccs    1
  hosszulepes   2
  hazmester     2
  vicehazmester 3
  krudyfroccs   1
  soherfroccs   9
  puskasfroccs  3
  ;

  
param wine_content :=
  kisfroccs     1
  nagyfroccs    2
  hosszulepes   1
  hazmester     3
  vicehazmester 2
  krudyfroccs   9
  soherfroccs   1
  puskasfroccs  6
  ;
```

-----

### More General Product-Mix Model

We feel that this model is still very specific to beverages made from soda and wine. If we were to have a problem instance with different products that use given portions of certain raw materials, and given were all the price and stock data, the model would be very similar. So now, try to create a model where it is not hardcoded to have two types of ingredients, but where the ingredients are given by a **set**.

```glp
set Products;
set Ingredients;

param price{Products};
param stock{Ingredients};
param content{Products,Ingredients};

var quantity{Products}>=0;

s.t. IngredientUsage{i in Ingredients}:
  sum{p in Products} quantity[p] * content[p,i] <= stock[i];

maximize Income:
  sum{p in Products} price[p] * quantity[p];

data;

set Products :=
  kisfroccs
  nagyfroccs
  hosszulepes
  hazmester
  vicehazmester
  krudyfroccs
  soherfroccs
  puskasfroccs
  ;

set Ingredients :=
  soda
  wine
  ;

param price :=
  kisfroccs     110
  nagyfroccs    200
  hosszulepes   120
  hazmester     260
  vicehazmester 200
  krudyfroccs   800
  soherfroccs   200
  puskasfroccs  550
  ;
  

param stock :=
  soda 1500
  wine 1000
  ;


param content :
                soda  wine  :=
  kisfroccs     1     1  
  nagyfroccs    1     2
  hosszulepes   2     1
  hazmester     2     3
  vicehazmester 3     2
  krudyfroccs   1     9
  soherfroccs   9     1
  puskasfroccs  3     6
  ;

end;
```

-----

### More General Festival Model

To test your skills, try to make a generic model for a more sophisticated festival example.

1.  First, to warm up, **include the price of each festival** and make the objective to **minimize the total cost** instead of the number of festivals.
2.  Secondly, define the **dates of the festivals** and introduce a new constraint: **you cannot be at two places at the same time** (i.e., a non-overlapping time constraint).
3.  Finally, try to extend the model with something of your own to make it more realistic.

-----

### Final Notes

The main point of this practice session was to get used to **generic models** and their syntax in **GMPL**.

