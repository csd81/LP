---------------
Problem 20.
85

5.7. ORDER FULFILLMENT

PRODUCTION PROBLEM

Solve Problem 18, a production problem example with arbitrary recipes, with the following modifications.
• Maximum usages for raw materials are reset. Instead of 23000 units of A, 31000 units of B and
450000 units of C and 200 units of D, the new max usage limits are 50000 units of A, 120000
units of B, 1000000 units of C and 1500 units of D.
• Initial funds are capped at 35000.
• There are three available orders with the following properties.

payment before
expense
income
maximum count
obtain A
obtain B
obtain C
obtain D
deliver P 1
deliver P 2
deliver P 3

Ord1
no
10000
−
10
20000
10000
300000
500
40
80
−

Ord2
no
10000
−
10
15000
10000
400000
500
45
70
6

Ord3
yes
−
500
30
190
20
3000
−
1
−
−

The data section implementation and the solution output are the following.
data;
set Raws := A B C D;
set Products := P1 P2 P3;
set Recipes := MakeP1 MakeP2 MakeP3 Comp1 Comp2;
param Min_Usage :=
B 21000
D 200
P2 100
;
param Max_Usage :=
A 50000
B 120000
C 1000000
D 1500
P3 10
;
param Value :=
A 1

86

5.7. ORDER FULFILLMENT

PRODUCTION PROBLEM

B 0.07
C 0.013
D 8
P1 252
P2 89
P3 139
;
param Recipe_Ratio:
A
B
C
MakeP1 200
25 3200
MakeP2
50 180 1000
MakeP3
0
75 4500
Comp1
240 200 4400
Comp2
51 250 5400
;

D
1
1
1
2
2

P1
1
0
0
1
0

P2
0
1
0
1
1

P3 :=
0
0
1
0
1

param Initial_Funds := 35000;
set Orders := Ord1 Ord2 Ord3;
param Order_Material_Flow:
A
B
C
D
Ord1 20000 10000 300000 500
Ord2 15000 10000 400000 500
Ord3
190
20
3000
0
;

P1
40
45
1

P2
80
70
0

P3 :=
0
6
0

param Order_Cash_Flow := # negative means income
Ord1 10000
Ord2 10000
Ord3 -500
;
param Order_Count :=
Ord1 10
Ord2 10
Ord3 30
;
param Order_Pay_Before :=
Ord1 0
Ord2 0
Ord3 1
;
end;
Total Costs: 26497.3
Total Revenue: 47202.7

87

5.7. ORDER FULFILLMENT

PRODUCTION PROBLEM

Profit: 20705.4
Acquiring order Ord1: 1x
Acquiring order Ord2: 0x
Acquiring order Ord3: 30x
Volume of recipe MakeP1: 0
Volume of recipe MakeP2: 553.716
Volume of recipe MakeP3: 0
Volume of recipe Comp1: 89.1554
Volume of recipe Comp2: 10
Raw materials (orders + market -> production + leftover):
Consumption of raw A: 25700 + 23893.1 -> 49593.1 + 0 (total: 49593.1)
Consumption of raw B: 10600 + 109400 -> 120000 + 0 (total: 120000)
Consumption of raw C: 390000 + 610000 -> 1e+06 + 0 (total: 1e+06)
Consumption of raw D: 500 + 252.027 -> 752.027 + 0 (total: 752.027)
Products (production -> orders + market):
Production of product P1: 89.1554 -> 70 + 19.1554 (total: 89.1554)
Production of product P2: 652.872 -> 80 + 572.872 (total: 652.872)
Production of product P3: 10 -> 0 + 10 (total: 10)
As there are much larger maximum usages for raw materials, and production is generally profitable, the extra capacities mean a significant increase in the objective. Also, there are orders used.
We can see that the optimal profit is 20705.4, with 89.16 units of P1, 553.72 units of P2, and 10
units of P3 produced altogether. We acquire Ord1 once, and Ord3 30 times, which is the maximum
available. Actually Ord3 is a lucrative way to produce and deliver product P1. There are significant
amounts obtained by orders for each raw material, and there are also purchased from the market.
For this reason, there are no leftovers after production. Some of the products are delivered, but in
all three products there are also amounts sold on the market.
Let us make an experiment with the integer nature of this model. As mentioned before, this
is an MILP model because of the order acquiring decisions, which can only be modeled by integer
variables. However, there is a built-in --nomip option for glpsol to relax all integer variables.
By relaxing we mean variables are not forced to be integers, just to be between their defined lower
and upper bounds, if any. By relaxing all integer variables of an MILP model, we obtain its LP
relaxation.
glpsol -m model.mod -d data.dat --nomip
If this option is used, the model is now treated as an LP. This can be solved much faster, but
integer variables are allowed to attain fractional values. If this happens, the solution is infeasible in
reality. Using the option in the aforementioned problem instance, the following result is reported.
Total Costs: 12163
Total Revenue: 33560
Profit: 21397
Acquiring order Ord1: 1x
Acquiring order Ord2: 0x
Acquiring order Ord3: 30x
Volume of recipe MakeP1: 0
Volume of recipe MakeP2: 550
Volume of recipe MakeP3: 0
Volume of recipe Comp1: 90
Volume of recipe Comp2: 10

88

5.8. PRODUCTION PROBLEM – SUMMARY

PRODUCTION PROBLEM

Raw materials (orders + market -> production + leftover):
Consumption of raw A: 35700 + 13910 -> 49610 + 0 (total: 49610)
Consumption of raw B: 15600 + 103900 -> 119500 + 0 (total: 119500)
Consumption of raw C: 540000 + 460000 -> 1e+06 + 0 (total: 1e+06)
Consumption of raw D: 750 + 0 -> 750 + 0 (total: 750)
Products (production -> orders + market):
Production of product P1: 90 -> 90 + 0 (total: 90)
Production of product P2: 650 -> 120 + 530 (total: 650)
Production of product P3: 10 -> 0 + 10 (total: 10)
What we can see is that the optimal solution of the LP relaxation is 21397, which is better
than for the MILP, 20705.4. This is natural, because the LP relaxation has a wider search space,
including all the solutions of the MILP and possibly others where integer variables take fractional
values. The LP relaxation has a practical importance not in the modeling, but the algorithmic
solution point of view. It is usually fast to solve the LP relaxation of an MILP, and if done, its
optimal solution is guaranteed to be a bound for the optimal solution of the MILP itself. This is
useful information as the MILP itself was hard to impossible to be solved to global optimality. But
any times, the actual optimal solution lies between the currently found best solution and a bound.
The LP relaxation is a suitable bound.
If we closely investigate the solution for the LP relaxation, it surprisingly seems „more integer”
than that of the MILP. However, because the objectives are different, we can be certain that some
integer variable has a fractional value. Actually, there are partially acquired orders, Ord1 is acquired
1.5 times. We can deduce this fact by looking at the material amounts related to orders. The reason
it was not reported is simply that order count was printed by the %d format specifier, which rounds
the fractional value before printing it out as an integer. Therefore the post-processing work is not
precise if the integer variables are relaxed. Alternatively %f or %g could be used.

5.8

Production problem – Summary

We started from the simplest case of production problems: where only available amounts of raw
materials are given, and we have to decide production composition to achieve the highest revenue.
We demonstrated how this problem may include upper and lower limits on production and consumption, how to optimize by a different objective if needed, and how we can take raw material
costs into consideration.
The diet problem is where optimal amount of certain food types shall be determined to satisfy
nutrition requirements. This, seemingly quite different problem resulted in a very similar implementation as the production problem. The two can actually be interpreted as special cases of a more
general production problem where recipes may consist of multiple raw materials and products at
the same time.
Finally, the concept of orders was introduced in the ultimate model of the chapter, which gives
it an integer nature, as we can acquire and fulfill orders only fully or not at all, but not partially.
This extension gives the raw material supply and final product demand side new possibilities, and
our problem is still linear. Additional data files are easily implemented if needed, from the basic to
the more complex problems at the same time, and can be solved with the same single model file.

89
