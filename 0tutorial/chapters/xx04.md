----------------------
Chapter 3

GNU MathProg
This chapter aims at briefly introducing GNU MathProg and how it can be used to implement and
solve mathematical programming models in the LP or MILP class. A short example problem is
presented with implementation, solution and results, with some of the most frequently used features
of the language shown.

3.1

Prerequisites for programming

GNU MathProg, also referred to as the GNU Mathematical Programming Language, or GMPL,
is a programming language for designing and solving LP and MILP. The GNU Linear Programming
Kit, GLPK provides free software to both parsing implemented models and solving them until the
optimal solution is reported. GLPK is available under the General Public License version 3.0 or
later [6].
There are other software tools for solving MILP models, some are available with a free license
like CBC, or lpsolve. These mentioned can be much faster than GLPK. Commercial software can
even be better, some of them are available through academic license. However, we selected GNU
MathProg and solver glpsol from GLPK because it is relatively easy to use and includes both
language and model solving tools.
Installing GLPK depends on the operating system. On Linux, we can head to the official website
of GLPK, where installation packages, source codes and even sample GNU MathProg problems can
be found. On some distributions, installation can be done with a single command as follows.
sudo apt-get install glpk-utils
If installation is complete, we shall have the program glpsol available in the command line.
Throughout this manual, we will use this tool to parse and solve models, in command line.
On Windows, there is a possibility to obtain the command line solver as well. However, a more
convenient option is a desktop application called GUSEK [9], which is a simple IDE with text
editor for the GNU MathProg programming language. The solver glpsol is available with all of
its functionalities there. With GUSEK, no command line is needed, although navigating between
multiple files requires some attention.
Reference manual for the GNU MathProg modeling language with usages of the glpsol software
is publicly available, see the references [1].

12

3.2. „HELLO WORLD!” PROGRAM

3.2

GNU MATHPROG

„Hello World!” program

After successful installation, we can try the program with a very simple LP problem. This will be
our first GNU MathProg program, like a „Hello World!”.
var x >= 0;
var y >= 0;
var z >= 0;
s.t. Con1: x + y <= 3;
s.t. Con2: x + z <= 5;
s.t. Con3: y + z <= 7;
maximize Sum: x + y + z;
solve;
printf "Optimal (max) sum is: %g.\n", Sum;
printf "x = %g\n", x;
printf "y = %g\n", y;
printf "z = %g\n", z;
end;
GNU MathProg is designed to be easy to read, and the mathematical meaning to be easy to
understood. The language consists of commands ending with a semicolon (;), these are called
statements. There are six distinct statements in this file: var, s.t., maximize, solve, printf
and end. The meanings of most are self-explanatory, as we will see.
var x >= 0;
var y >= 0;
var z >= 0;
First of all, this is an LP problem, all three variables x, y and z can take real values. Also,
they have bounds defined: each of them must be nonnegative. Note that this is the most common
bound for variables.
s.t. Con1: x + y <= 3;
s.t. Con2: x + z <= 5;
s.t. Con3: y + z <= 7;
In the problem, there are three constraints, apart from the bounds, which are treated differently
in the language. The constraints are named Con1, Con2, Con3, respectively. The names are preceded
by „s.t.”, but it has several aliases, it can be „ subject to”, or can be omitted at all. The constraints
state that the sum of any two of the three variables cannot be greater than given constants, which
are 3, 5 and 7, respectively.
maximize Sum: x + y + z;
The goal of the optimization is to maximize the objective entitled as „Sum”, which is, of course,
the sum of the three variables. There can be at most one maximize or minimize statement in a
model file.
13

3.2. „HELLO WORLD!” PROGRAM

GNU MATHPROG

At this point, the LP problem is well defined. This is a relatively easy linear problem, however,
its optimal solution might be not obvious for first sight.
It shall be noted that the objective function can be omitted at all from a GNU MathProg model
formulation. In this case, the only task is to find any feasible solution for the problem.
solve;
printf "Optimal (max) sum is: %g.\n", Sum;
printf "x = %g\n", x;
printf "y = %g\n", y;
printf "z = %g\n", z;
end;
There is a solve statement in the file. This denotes the point where the solver software should
finish reading all the data, then constructing and solving the model. After the solve statement,
there may still be other statements in the file, to report valuable information about our solution.
In this case, the objective value and our three variables are printed with their values obtained by
the optimization procedure. The printf statement works similarly to the printf() function from
the C programming language, but has less supported format specifiers. We prefer the %g format,
because it can print both integers and fractional values in a short form. In some cases, a fixed
precision number is more adequate, like %.3f.
An end statement denotes the end of the model description, although it is optional.
We can use any text editor we like, but some of them have syntax highlight options. GUSEK on
Windows has its own text editor which is specifically designed to modeling. On Linux, we can use
gedit. It does not have a syntax highlight for GNU MathProg by default, but one can be obtained
from the internet.
Let us name this exact file as helloworld.mod. On some systems, the file extension .mod can
be recognized as a video format by the file browser. This causes the „double-click” opening method
to try to open the file as a video instead of a text file. For this reason, it is recommended to set the
opening method of the file to the text editor we prefer, for example gedit. Alternatively, we can
simply use a different file extension, like .m, or simply .txt, it does not matter from the viewpoint
of glpsol, although it may matter if we use some IDE for programming like GUSEK.
File helloworld.mod is a model file, because it contains the business logic of the problem
we want to solve. It is alone enough for defining a problem. Later on, we will split our problem
formulations to a single model file and one or more data files. The model file encapsulates the logic
of the problem, while the data file(s) provide the actual data the problem shall be solved with. This
will be useful, because if the data of the real-world problem changes, we do not need to tamper with
the model itself. In other words, a user who wants to solve a model for a particular problem does
not need to know the model, only a data file must be implemented correctly, which is much easier
and less error-prone.
Use glpsol to solve the model file with the following command.
glpsol -m helloworld.mod
Something similar to the following output is obtained.
GLPSOL: GLPK LP/MIP Solver, v4.65
Parameter(s) specified in the command line:
-m helloworld.mod

14

3.2. „HELLO WORLD!” PROGRAM

GNU MATHPROG

Reading model section from helloworld.mod...
20 lines were read
Generating Con1...
Generating Con2...
Generating Con3...
Generating Sum...
Model has been successfully generated
GLPK Simplex Optimizer, v4.65
4 rows, 3 columns, 9 non-zeros
Preprocessing...
3 rows, 3 columns, 6 non-zeros
Scaling...
A: min|aij| = 1.000e+00 max|aij| = 1.000e+00 ratio =
Problem data seem to be well scaled
Constructing initial basis...
Size of triangular part is 3
*
0: obj = -0.000000000e+00 inf =
0.000e+00 (3)
*
3: obj =
7.500000000e+00 inf =
0.000e+00 (0)
OPTIMAL LP SOLUTION FOUND
Time used:
0.0 secs
Memory used: 0.1 Mb (102283 bytes)
Optimal (max) sum is: 7.5.
x = 0.5
y = 2.5
z = 4.5
Model has been successfully processed

1.000e+00

This is a small problem, therefore the result is almost instantaneous. Let us observe what
information can be read from the output.
GLPSOL: GLPK LP/MIP Solver, v4.65
Parameter(s) specified in the command line:
-m helloworld.mod
Reading model section from helloworld.mod...
18 lines were read
Generating Con1...
Generating Con2...
Generating Con3...
Generating Sum...
Model has been successfully generated
The first section of the output is printed during the model generation procedure. Note that if
the model has bad syntax, it is remarked here. Only the first error is displayed. It can also be
observed that the constraints and objective are the model elements that must be „generated”.
GLPK Simplex Optimizer, v4.65
4 rows, 3 columns, 9 non-zeros
Preprocessing...
3 rows, 3 columns, 6 non-zeros
Scaling...

15

3.2. „HELLO WORLD!” PROGRAM

GNU MATHPROG

A: min|aij| = 1.000e+00 max|aij| = 1.000e+00 ratio =
Problem data seem to be well scaled
Constructing initial basis...
Size of triangular part is 3
*
0: obj = -0.000000000e+00 inf =
0.000e+00 (3)
*
3: obj =
7.500000000e+00 inf =
0.000e+00 (0)
OPTIMAL LP SOLUTION FOUND
Time used:
0.0 secs
Memory used: 0.1 Mb (102283 bytes)

1.000e+00

The solution procedure of an LP problem from the constraints themselves to the final, optimal
solution is itself an interesting subject of Operations Research. However, we do not focus on the
underlying solution algorithms themselves. However, basic knowledge about it would help us debugging in the future. First of all, all LP problems are represented in a matrix of coefficients, the
rows of which are corresponding to constraints (and the objective), the columns corresponding to
variables, and the entries of the matrix being the coefficients of a given variable in a given constraint.
On this matrix, some preprocessing steps are performed, and then the main algorithm is launched.
There are two rows in this output which show a „current” result. The first one shows an objective
of 0, the second shows the objective 7.5 which is actually the final optimal solution. The row
„OPTIMAL LP SOLUTION FOUND” denotes that the solver succeeded in solving the problem,
and is now aware of the optimal solution and the corresponding values of the variables. If there are
multiple optimal solutions, one of them is chosen.
With more complex problems, solution can take a considerable amount of time and current
best solutions are regularly displayed. The solution procedure may be ended before arriving to the
optimal solution, in which case the best feasible solution found so far is reported. This happens, for
example, when a time limit is set to glpsol and it is exceeded during the procedure.
Optimal (max) sum is: 7.5.
x = 0.5
y = 2.5
z = 4.5
Model has been successfully processed
Finally, we can see the result of the printf statements that we added at the end. We can
see that the optimal solution is x = 21 = 0.5, y = 52 = 2.5, z = 92 = 4.5, and then the objective
function is x + y + z = 15
2 = 7.5. This result means we cannot choose values for the variables
to obtain a larger sum, unless at least one of the constraints (or bounds) are violated. Note that
printf statements are also valid before the solve statement, that is, during the model construction
procedure. However, before the solve statement, variables and the objective are not available, as
they had not been calculated by that point. The final Model has been successfully processed
message hints us that the solver call was successful.
We shall also note that glpsol command line tool has many other options available. For example,
we can ourselves print an automated solution file with the -o option. We can also save the output
of the program with the --log option. Also, the constructed model can be exported to formats that
other MILP solvers can use. For example, with the --wlp option, we can export to CPLEX-LP matrix
format, which is supported by many other solver software. Perhaps we do want to use glpsol to
solve the model, we only need it to translate the model to some other format. Then, the --check
option ensures that the model is only parsed, but not solved. It is also possible to manipulate the
solution procedure in many ways.
Now that we have successfully formulated, solved and analyzed the output for our first LP
problem implemented in GNU MathProg, let us make a slight change in the model file. Add the
16

3.2. „HELLO WORLD!” PROGRAM

GNU MATHPROG

integer restriction to all three of the variables, as follows. The modified file is now saved as
helloworld-int.mod.
var x >= 0, integer;
var y >= 0, integer;
var z >= 0, integer;
From now, this is no more an LP model, but an MILP model, because some (in particular, all)
of the variables must take integer values. Solving the model with glpsol is the same.
glpsol -m helloworld-int.mod
The solver identifies the model as MILP, and there are some changes in the generated output.
Solving LP relaxation...
GLPK Simplex Optimizer, v4.65
3 rows, 3 columns, 6 non-zeros
*
0: obj = -0.000000000e+00 inf =
0.000e+00 (3)
*
4: obj =
7.500000000e+00 inf =
0.000e+00 (0)
OPTIMAL LP SOLUTION FOUND
Integer optimization begins...
Long-step dual simplex will be used
+
4: mip =
not found yet <=
+inf
+
6: >>>>>
7.000000000e+00 <=
7.000000000e+00
+
6: mip =
7.000000000e+00 <=
tree is empty
INTEGER OPTIMAL SOLUTION FOUND
Time used:
0.0 secs
Memory used: 0.1 Mb (124952 bytes)
Optimal (max) sum is: 7.
x = 1
y = 2
z = 4
Model has been successfully processed

(1; 0)
0.0% (2; 0)
0.0% (0; 3)

We can observe that a so-called LP relaxation is solved first, the output for which seems the
be the same as the output for our initial LP problem. Actually, this is the nature of the solution
algorithm, it is first solved as if all the integer restrictions were removed, as an LP problem. Then,
the actual MILP model is solved, and we find that the optimal solution is only 7.0 instead of the
optimal solution of the LP, which was 7.5.
This is not surprising. The only difference between the two models is that the integer problem
is more restrictive about the variables. That means, any solution to the MILP is a solution to the
LP. But the opposite is not true, as the optimal solution of the LP, x = 0.5, y = 2.5, z = 4.5 was
eliminated by the integer restrictions. The LP relaxation is an important concept in solving MILP
models - for example, it can be used as a good initial solution, trying to make all the variables to
obtain integer variables. Also, if the integer variables all turn out to have integer values in the LP
relaxation, then it is guaranteed to be an optimal solution for the MILP as well, because the MILP
is the more restricted.
In this model, the solver needed a little extra work for the MILP, and found the solution of
x = 1, y = 2 and z = 4. Note that it is an optimal solution, but not the only one. x = 0, y = 3,
z = 4, and x = 0, y = 2, z = 5 are also feasible and optimal solutions with the same objective value
of 7.0.
17

3.2. „HELLO WORLD!” PROGRAM

GNU MATHPROG

As we could suspect, the algorithmic procedure behind the MILP can be substantially more
complex than that of an LP. However, the difference in the formulation is only the integer restrictions
of the variables.
We should keep in mind that solvers can handle a large number of variables and constraints of
an LP model, but usually they can only handle a limited number of integer variables of an MILP
model. The exact limit for integer variables strongly depends on the model itself, it can range from
dozens to thousands.

18
