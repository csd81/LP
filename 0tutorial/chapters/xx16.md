

## Problem 18

Solve **Problem 14**, the original production problem, using the exact same data, but with two additional production options.

  * **P1** and **P2** can be produced jointly, with slightly different consumption amounts than when produced separately. Producing one unit of both products requires **240 units** of raw material $\text{A}$ (instead of 250 when done separately), **200 units** of raw material $\text{B}$ (instead of 205 when done separately), **4,400 units** of raw material $\text{C}$ (slightly more than 4,200 when done separately), and **2 units** of raw material $\text{D}$ (exactly as if done separately).

  * Similarly, **P2** and **P3** can also be produced jointly. The costs are **51 units** of raw material $\text{A}$ (slightly more than 50 when done separately), **250 units** of raw material $\text{B}$ (instead of 255 when done separately), **5,400 units** of raw material $\text{C}$ (instead of 5,500 when done separately), and **2 units** of raw material $\text{D}$ (exactly as if done separately).

This problem can be solved by manipulating the data section of the original problem. We need to add two extra *recipes* to the **Recipes** set, then two rows to the **Recipe\_Ratios** parameter to describe these two new recipes. The data section and the results are as follows:

```
data;
set Raws := A B C D;
set Products := P1 P2 P3;
set Recipes := MakeP1 MakeP2 MakeP3 Comp1 Comp2;
param Min_Usage :=
B 21000
D 200

P2 100
;

param Max_Usage :=
A 23000
B 31000
C 450000
D 200
P3 10
;

param Value :=
A 1
B 0.07
C 0.013
D 8
P1 252
P2 89
P3 139
;

param Recipe_Ratio:
A      B      C      D    P1  P2  P3 :=
MakeP1 200    25     3200   1    1   0   0
MakeP2 50     180    1000   1    0   1   0
MakeP3 0      75     4500   1    0   0   1
Comp1  240    200    4400   2    1   1   0
Comp2  51     250    5400   2    0   1   1
;

end;
```

-----

### Production Results

| Metric | Value |
| :--- | :--- |
| **Total Costs** | $30,495.00$ |
| **Total Revenue** | $32,460.62$ |
| **Profit** | $1,965.62$ |

-----

### Recipe Volumes

| Recipe | Volume |
| :--- | :--- |
| Volume of recipe **MakeP1** | 0 |
| Volume of recipe **MakeP2** | 6.25 |
| Volume of recipe **MakeP3** | 0 |
| Volume of recipe **Comp1** | 86.875 |
| Volume of recipe **Comp2** | 10 |

-----

### Raw Material Usage

| Raw Material | Consumption |
| :--- | :--- |
| Consumption of raw **A** | $21,672.5$ |
| Consumption of raw **B** | $21,000$ |
| Consumption of raw **C** | $442,500$ |
| Consumption of raw **D** | $200$ |

-----

### Product Production

| Product | Production |
| :--- | :--- |
| Production of product **P1** | $86.875$ |
| Production of product **P2** | $103.125$ |
| Production of product **P3** | $10$ |

-----

The optimal solution is **$1,965.62$**, which is a bit better than the original **$1,577.45$**. This is because the only modification was adding new production opportunities, which widened the search space. We can also see that **Comp1** and **Comp2**, the recipes for the joint production methods, are used as an alternative to the original options. There are still a few units (6.25) of **P2** produced alone, though. The total production is also slightly different in this solution, with **86.88 units** of $\text{P1}$, **103.13 units** of $\text{P2}$, and **10 units** of $\text{P3}$.

-----

## 5.7 Order Fulfillment

Now we have a complete model for the production problem of arbitrary recipes, which allows us to easily implement and solve a wide range of problems, including the diet problem. We will further extend the model with a new, practically important feature: **orders**. Orders allow materials to be bought and sold in bulk. This is potentially a more lucrative option but can only be acquired entirely or ignored completely.

So far in the production problem topic, we only had **real-valued variables**; therefore, all the models were **Linear Programming (LP)** models. Now, we will introduce **integer variables**, making the model a **Mixed Integer Linear Programming (MILP)** model. We must note that while MILP models are easy to implement, the solution procedure can take an unacceptably long time if there are too many **binary variables**. The limit on what is considered *too many* depends on the model: in some problems, we can only have several dozens of integer variables, while sometimes several hundreds or even thousands will work. Regardless, this limit is definitely lower than the number of ordinary real-valued variables in LP models. Unfortunately, in many situations, the limitations can only be slightly pushed up by choosing stronger equipment, better solvers, or improved modeling techniques, because **integer programming** is an **NP-Complete problem**. Nevertheless, using integer variables is a very powerful modeling tool that allows a significantly wider range of problems to be potentially modeled by MILP than those by LP.

We will see an example of how a **GNU MathProg** model can be extended with new features while maintaining compatibility with old data files. We will also see how we can use a filter within an indexing expression in **GNU MathProg**.

An **order** is a fixed amount of several raw materials that are purchased and/or products that are sold when ready by the producing party. An order can either cost money or gain income, and payment may happen either before or after all the production takes place. The same order may be fulfilled multiple times.

The general problem definition for arbitrary recipes and order fulfillment is the following.

 