
# Chapter 4

### Equation Systems

In this chapter, we present the basic capabilities of the GNU MathProg language using an example modeling problem: the general solution of linear equation systems. The aim is to navigate from a straightforward initial implementation to the use of indexing and separated model and data sections.

With this knowledge, code maintenance and solving the model with different instances (different data) become very easy, provided the model is correctly implemented in the first place. This is the standard approach we intend to use for future models.

Note that solving linear systems of equations is considered a routine task. There are plenty of capable software tools available, either standalone or embedded. A well-known algorithm is Gaussian elimination [10]. However, we are currently interested in modeling rather than solution algorithms—specifically, GNU MathProg implementation techniques.

---

### 4.1 Example System

Let’s begin by solving a small system of equations using GNU MathProg.

**Problem 4.**
Solve the following system of equations in the real domain.

$$
\begin{aligned}
2 (x - y) &= -5 \\
y - z &= w - 5 \\
1 &= y + z \\
x + 2w &= 7y - x
\end{aligned}
$$
(8)

Although not explicitly stated in the problem description, there are four variables: $x$, $y$, $z$, and $w$. The "real domain" means that all of these can independently take arbitrary real values. Our goal is to find values for these four variables such that all four equations are true.

If a complete analysis of the problem were required, the goal would be not only to find a single solution but to find *all* of them. If there were infinitely many solutions, we would need to characterize this infinite set and prove that no other solutions exist. However, for the sake of simplicity, we currently only want to find a single solution to the system of equations without determining if others exist.

Therefore, this is a feasibility problem, meaning only a single feasible solution needs to be found. There is no need for an objective function to optimize, as there are no better or worse solutions.

It can be observed that Problem 4 describes a linear system of equations. This becomes apparent after we arrange the equations into the following format:

$$
\begin{aligned}
2x - 2y - w &= -5 \\
y - z - w &= -5 \\
y + z &= 1 \\
2x - 7y + 2w &= 0
\end{aligned}
$$
(9)

The point is that this arrangement can be obtained from the original system by simplifying each equation individually: removing parentheses and adding or merging terms on both sides. In this way, the arranged system is equivalent to the original. On the left-hand side (LHS) of each equation, there is a linear expression of the variables (each multiplied by a constant and then added), and on the right-hand side (RHS), there is a constant. Therefore, all equations are linear.

If we further add zero terms and emphasize the coefficients in each column of the arranged format, we get the following equivalent form of the same system:

$$
\begin{aligned}
(+2) \cdot x + (-2) \cdot y + 0 \cdot z + 0 \cdot w &= -5 \\
0 \cdot x + (+1) \cdot y + (-1) \cdot z + (-1) \cdot w &= -5 \\
0 \cdot x + (+1) \cdot y + (+1) \cdot z + 0 \cdot w &= 1 \\
(+2) \cdot x + (-7) \cdot y + 0 \cdot z + (+2) \cdot w &= 0
\end{aligned}
$$
(10)

Although this representation is less readable, it represents more generally what a system of linear equations actually means. For each equation, there is a constant right-hand side and a linear expression on the left-hand side, for which we only need to know the coefficients for each variable. Thus, this whole problem can be represented in a matrix of coefficients, where the rows correspond to equations and the columns correspond to variables—except for the rightmost column, which corresponds to the right-hand side. 

This is very close to what we call the standard form of a Linear Programming problem. The standard form also includes $\ge 0$ bounds for all variables, consists of $\le$ inequalities instead of equations, and, of course, has a linear objective function. This matrix-like form is important because it inspires solution algorithms. However, we will not go into the details of solution algorithms here, neither for systems of equations nor for LP problems.

Instead, the representation shown in Equation System 10 will be useful for understanding the general scheme behind systems of linear equations and for implementing a separated GNU MathProg MILP model. For this model, a data section describing an arbitrary system of linear equations can be provided and solved.

Now, let's see what the code looks like in GNU MathProg. First, the most straightforward implementation is shown, without arranging the equations.

```
var x;
var y;
var z;
var w;
s.t. Eq1: 2 * (x - y) = -5;
s.t. Eq2: y - z = w - 5;
s.t. Eq3: 1 = y + z;
s.t. Eq4: x + 2 * w = 7 * y - x;
solve;

printf "x = %g\n", x;
printf "y = %g\n", y;
printf "z = %g\n", z;
printf "w = %g\n", w;
end;
```

As we can see here, GNU MathProg allows the use of parentheses and basic operations, provided that the constraints—now named Eq1, Eq2, Eq3, and Eq4—simplify into an equality (or non-strict inequality) between two linear expressions.

If we solve the model file above, the solution $x = 0.5$, $y = 3$, $z = -2$, and $w = 10$ is obtained. This solution is unique, so all solution methods should end up with this exact result. We can also manually verify that all four equations are satisfied with the resulting variable values. The code itself helps us by printing the values of the four variables to the solver output.

Now, if we were to implement the aligned version, we would get the following:

```
s.t. Eq1: 2 * x + (-2) * y +    0 * z +    0 * w = -5;
s.t. Eq2: 0 * x +    1 * y + (-1) * z + (-1) * w = -5;
s.t. Eq3: 0 * x +    1 * y +    1 * z +    0 * w = 1;
s.t. Eq4: 2 * x + (-7) * y +    0 * z +    2 * w = 0;
```

As we can see, whitespace characters can be freely used in GNU MathProg to improve readability. Also, zero-coefficient terms can be eliminated from the expressions and padded with whitespace instead. The rest of the model file can remain unchanged. The result of solving this arranged model file should be the same.

---

### 4.2 Modifications in Code

Now that we have a working model file that solves a particular system of linear equations, let's try to solve another one obtained by making slight modifications to the original. The problem description is as follows:

